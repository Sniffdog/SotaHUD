#include "sotacalcs.h"
#include <algorithm>

sotaCalcs::sotaCalcs()
{

}

const int sotaCalcs::MAX_DECAY_TIME_HOURS = 12;
const float sotaCalcs::DECAY_RATE_PER_HOUR =  1.0 / 400.0 / 24; //Current decay rate, roughly 0.01% of total exp pool

long long sotaCalcs::getPAExperienceForLevel(int level)
{
    int actualLevel = level - 2; //They have an offset, it makes the math work
    return experienceForPALevel[actualLevel];
}
long long sotaCalcs::getPAExperienceForNextLevel(int level)
{
    int actualLevel = level - 2; //They have an offset, it makes the math work
    return experienceForPALevel[actualLevel+1]-experienceForPALevel[actualLevel];
}

long long sotaCalcs::getPADecay(int level, int hours)
{
   return getPAExperienceForLevel(level) * std::min(MAX_DECAY_TIME_HOURS,hours) * DECAY_RATE_PER_HOUR;

}

long long sotaCalcs::getSkillExperienceForLevel(int level)
{
    int actualLevel = level - 2; //They have an offset, it makes the math work
    return experienceForSkillLevel[actualLevel];
}

long long sotaCalcs::getSkillExperienceForNextLevel(int level)
{
    int actualLevel = level - 2; //They have an offset, it makes the math work
    return experienceForSkillLevel[actualLevel+1]-experienceForSkillLevel[actualLevel];
}

const long long sotaCalcs::experienceForPALevel[] =
    {
      1000LL,
      2100LL,
      3310LL,
      4641LL,
      6105LL,
      7715LL,
      9486LL,
      11434LL,
      13577LL,
      15934LL,
      18527LL,
      21379LL,
      24516LL,
      27967LL,
      31763LL,
      35939LL,
      40532LL,
      45585LL,
      51143LL,
      57257LL,
      63982LL,
      71380LL,
      79518LL,
      88469LL,
      98315LL,
      109146LL,
      121060LL,
      134166LL,
      148582LL,
      164440LL,
      181884LL,
      201072LL,
      222179LL,
      245396LL,
      270935LL,
      299028LL,
      329930LL,
      363923LL,
      401315LL,
      442446LL,
      487690LL,
      537459LL,
      592204LL,
      652424LL,
      718666LL,
      791532LL,
      871685LL,
      959853LL,
      1056838LL,
      1163521LL,
      1280873LL,
      1409960LL,
      1551956LL,
      1708151LL,
      1879966LL,
      2068962LL,
      2276858LL,
      2505543LL,
      2757097LL,
      3033806LL,
      3338186LL,
      3673004LL,
      4041304LL,
      4446434LL,
      4892077LL,
      5382284LL,
      5921512LL,
      6514663LL,
      7167129LL,
      7884841LL,
      8674325LL,
      9542757LL,
      10498032LL,
      11548835LL,
      12704718LL,
      13976189LL,
      15374807LL,
      16913287LL,
      18605615LL,
      20467176LL,
      22514893LL,
      24767382LL,
      27245120LL,
      29970632LL,
      32968695LL,
      36266564LL,
      39894220LL,
      43884642LL,
      48274106LL,
      53102516LL,
      58413767LL,
      64256143LL,
      70682757LL,
      77752032LL,
      85528235LL,
      94082058LL,
      103491263LL,
      113841389LL,
      125226527LL,
      137750179LL,
      151526196LL,
      166679815LL,
      183348796LL,
      201684675LL,
      221854142LL,
      244040556LL,
      268445611LL,
      295291172LL,
      324821289LL,
      357304417LL,
      393035858LL,
      432340443LL,
      475575487LL,
      523134035LL,
      575448438LL,
      632994281LL,
      696294709LL,
      765925179LL,
      842518696LL,
      926771565LL,
      1019449721LL,
      1121395693LL,
      1233536262LL,
      1356890888LL,
      1492580976LL,
      1641840073LL,
      1806025080LL,
      1986628588LL,
      2185292446LL,
      2403822690LL,
      2644205959LL,
      2908627554LL,
      3199491309LL,
      3519441439LL,
      3871386582LL,
      4258526240LL,
      4684379864LL,
      5152818850LL,
      5668101735LL,
      6234912908LL,
      6858405198LL,
      7544246717LL,
      8298672388LL,
      9128540626LL,
      10041395688LL,
      11045536256LL,
      12150090881LL,
      13365100969LL,
      14701612065LL,
      16171774271LL,
      17788952698LL,
      19567848967LL,
      21524634863LL,
      23677099349LL,
      26044810283LL,
      28649292311LL,
      31514222542LL,
      34665645796LL,
      38132211375LL,
      41945433512LL,
      46139977863LL,
      50753976649LL,
      55829375313LL,
      61412313844LL,
      67553546228LL,
      74308901850LL,
      81739793035LL,
      89913773338LL,
      98905151671LL,
      108795667838LL,
      119675235621LL,
      131642760183LL,
      144807037201LL,
      159287741921LL,
      175216517113LL,
      192738169824LL,
      212011987806LL,
      233213187586LL,
      256534507344LL,
      282187959078LL,
      310406755985LL,
      341447432583LL,
      375592176841LL,
      413151395525LL,
      454466536077LL,
      499913190684LL,
      549904510752LL,
      604894962827LL,
      665384460109LL,
      731922907119LL,
      805115198830LL,
      885626719713LL,
      974189392684LL,
      1071608332952LL,
      1178769167247LL,
      1296646084971LL,
      1426310694468LL,
      1568941764914LL,
      1725835942405LL,
      1898419537645LL
    };

const long long sotaCalcs::experienceForSkillLevel[] =
    {
      10LL,
      21LL,
      33LL,
      46LL,
      60LL,
      76LL,
      93LL,
      112LL,
      133LL,
      156LL,
      181LL,
      209LL,
      239LL,
      272LL,
      309LL,
      349LL,
      393LL,
      442LL,
      496LL,
      555LL,
      620LL,
      692LL,
      771LL,
      858LL,
      953LL,
      1058LL,
      1173LL,
      1300LL,
      1440LL,
      1594LL,
      1763LL,
      1949LL,
      2153LL,
      2378LL,
      2625LL,
      2897LL,
      3196LL,
      3525LL,
      3887LL,
      4285LL,
      4723LL,
      5205LL,
      5735LL,
      6318LL,
      6959LL,
      7664LL,
      8440LL,
      9294LL,
      10233LL,
      11266LL,
      12402LL,
      13652LL,
      15027LL,
      16539LL,
      18202LL,
      20032LL,
      22045LL,
      24259LL,
      26694LL,
      29373LL,
      32320LL,
      35562LL,
      39128LL,
      43050LL,
      47365LL,
      52111LL,
      57332LL,
      63075LL,
      69392LL,
      76341LL,
      83985LL,
      92393LL,
      101642LL,
      111816LL,
      123007LL,
      135317LL,
      148858LL,
      163753LL,
      180138LL,
      198161LL,
      217987LL,
      239795LL,
      263784LL,
      290172LL,
      319199LL,
      351128LL,
      386250LL,
      424885LL,
      467383LL,
      514131LL,
      565554LL,
      622119LL,
      684340LL,
      752784LL,
      828072LL,
      910889LL,
      1001987LL,
      1102195LL,
      1212424LL,
      1333676LL,
      1467053LL,
      1613768LL,
      1775154LL,
      1952679LL,
      2147956LL,
      2362761LL,
      2599047LL,
      2858961LL,
      3144867LL,
      3459363LL,
      3805309LL,
      4185849LL,
      4604443LL,
      5064897LL,
      5571396LL,
      6128545LL,
      6741409LL,
      7415559LL,
      8157124LL,
      8972846LL,
      9870140LL,
      10857164LL,
      11942890LL,
      13137189LL,
      14450917LL,
      15896018LL,
      17485629LL,
      19234201LL,
      21157631LL,
      23273404LL,
      25600754LL,
      28160839LL,
      30976932LL,
      34074635LL,
      37482108LL,
      41230328LL,
      45353370LL,
      49888717LL,
      54877598LL,
      60365367LL,
      66401913LL,
      73042114LL,
      80346335LL,
      88380978LL,
      97219085LL,
      106941003LL,
      117635113LL,
      129398634LL,
      142338507LL,
      156572367LL,
      172229613LL,
      189452584LL,
      208397852LL,
      229237647LL,
      252161421LL,
      277377573LL,
      305115340LL,
      335626884LL,
      369189582LL,
      406108550LL,
      446719415LL,
      491391366LL,
      540530512LL,
      594583573LL,
      654041940LL,
      719446144LL,
      791390768LL,
      870529854LL,
      957582849LL,
      1053341143LL,
      1158675267LL,
      1274542803LL,
      1401997093LL,
      1542196812LL,
      1696416503LL,
      1866058163LL,
      2052663989LL,
      2257930397LL,
      2483723446LL,
      2732095800LL,
      3005305390LL,
      3305835939LL,
      3636419542LL,
      4000061506LL,
      4400067666LL,
      4840074442LL,
      5324081896LL,
      5856490095LL,
      6442139114LL,
      7086353035LL,
      7794988348LL,
      8574487192LL,
      9431935921LL,
      10375129523LL,
      11412642485LL,
      12553906743LL,
      13809297427LL,
      15190227179LL,
      16709249906LL,
      18380174906LL
    };
